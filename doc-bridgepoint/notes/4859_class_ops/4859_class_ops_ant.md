--

This work is licensed under the Creative Commons CC0 License

---

# Class-based operations in a class are not clearly distinguishable from instance-based operations
### xtUML Project Analysis Note

### 1. Abstract

Class-based operations in a class are not clearly distinguishable from
instance-based operations. They appear in the same way. In BridgePoint 6.1 they
were underlined to distinguish them form instance-based operations. This is the
UML standard notation.

### 2. Document References

<a id="2.1"></a>2.1 [Service Pro SR #4859](https://support.onefact.net/issues/4859) Headline issue  

### 3. Background

None.

### 4. Requirements

4.1 Class-based operations shall be clearly distinguishable from instance-based
operations on the canvas.  
4.1.1 Class-based operations shall be underlined.  
4.2 Class-based operations shall be clearly distinguishable from instance-based
operations in model explorer.  

### 5. Analysis

5.1 Styling compartment text

5.1.1 Existing work

There was actually quite a bit of existing work in this area. The model of
graphics communicates with the xtUML meta-model using an EE called `Client`. The
way the model of graphics and this interface are designed, the graphics model
does not need any knowledge of the meta-model itself, but can get the graphical
information it needs in generic ways. One of the ways it does this is by
invoking operations on the meta-model with an agreed upon naming convention. To
get the text inside a compartment of a shape, the `Client` interface invokes an
operation called `get_compartment_text` with an integer compartment number. This
operation returns a string blob of text.

There exists another operation that `Client` can invoke called `get_text_style`.
This operation takes an integer compartment number, an integer line number, and
returns a value of enumeration type `Style`. As it turns out, OAL is already in
place to return `Style::Underlined` for lines in the operations compartment of a
class which contain class based operations.

On the graphics side, another EE called `Graphics Platform` exists to interface
with the SWT graphics package. This EE has a bridge called `drawText` that is
used for drawing text on the canvas. This bridge already takes a style
parameter, however it does not do anything different based on the value of the
parameter.

5.1.2 Remaining work

The only work remaining is to extend the `Graphics Platform` EE (which is
written in realized Java) to take the text style parameter and produce text
which is styled appropriately.

5.1.3 Existing bug

During analysis, a bug was found in the existing text styling work. This bug was
never noticed because the text styling functionality is not fully implemented as
described above. The `get_compartment_text` operation for `Model
Class` produces a text string for the operation compartment by navigating from
the first operation to the last operation using the ordering association built
into the meta-model. The `get_text_style` operation on the other hand "selects
many" operations and processes them in a for loop (resulting in output based on
persistence order and not the order the modeler specified). Because of this
discrepancy, the styling and the text can get out of sync if a user reorders
operations. The simple solution to this bug is to modify `get_text_style` to
iterate through the operations using the ordering association.

5.2 Changing model explorer icon

It would be good to have two different icons for operations in model explorer
for class based and instance based operations. We have precedent for doing this
already as interface messages have different icons depending on their direction
even though the instances are of the same type.

The place where icons are handled is in the `CorePlugin` class in the
`org.xtuml.bp.core` plugin. This class is generated by
`create_core_plugin_class.arc`. To implement different icons for each type of
operation, a special case would have to be added in this archetype to
distinguish between class based and instance based operations. The existing
patterns can be followed.

### 6. Work Required

6.1 Fix existing bug described in 5.1.3.  
6.2 Modify `GR::drawText` to draw styled text based on the `text_style`
parameter.  
6.3 Introduce new icons for class based and instance based operations.  
6.4 Modify `create_core_plugin_class.arc` to have a special case for
distinguishing between class based operations and instance based operations and
provide a different icon accordingly.  
6.4.1 Consider impact on other paths that utilize the icons (e.g. content
assist).  

### 7. Acceptance Test

7.1 A manual test shall be defined in which the visual differentiation of
operations in model explorer and on the canvas shall be tested.

### End
